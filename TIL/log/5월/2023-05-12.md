# 2023-05-12

# Log


## 데일리

로이가 뇌졸중에 이야기를 해줬다. 뇌졸중이 엄청나게 심각한 병이고, 빠르게 조치해야하는 병임을 알 수 있었다.

나중에 자세한 이야기를 해준다고했는데 기대된다.

로이 이야기는 들을수록 배울점이 많은 것 같다. 😀

## 수업

수업때 키아라, 비버, 조이, 도치, 애쉬랑 미션 진행에 대한 토론을 했다.

```markdown
# API 설계 방법과 그 이유

-   요구사항에 따른 시나리오 정의를 했다.
-   용어정리를 먼저 했다.
-   시나리오에 필요한 API를 정의했다.
-   인수테스트를 작성하면서 요청과 응답형태에 대해 생각해봤다.
    -   Sections API를 둘지 Line API를 활용할 지 REST API에 대한 고민이 있었다.
    -   노선에 역을 등록한다는 행위를 기준으로 Line API에 노선에 역을 추가하는 행위를 추가함.

# 테이블 설계 방법과 그 이유

---

-   용어사전에서 테이블로 분리될만한 용어들을 뽑아왔다.
    -   line, station, section
-   테이블 구조로 표현했을 때 section이라는 개념은 line과 station의 매핑테이블로 표현할 수 있었다.
-   방향을 담을지 고민했고, 컬럼명으로 충분히 방향을 표현할 수 있을것이라고 판단하여 방향을 제거했다.
-   외래키를 설정하지 않았다.
    -   CRUD를 할 때 다른 객체(테이블)에 제약을 받아서 단위테스트가 어려워짐

# 객체 설계 방법과 그 이유

---

-   테이블과 별도로 분리해서 생각했다.
-   도메인의 관점에서 봤을 때 line이 List<Section>을 가진다고 생각함.
-   가장 까다로웠던 비즈니스로직인 역 추가를 도메인에게 책임을 주고자 했음.
-   도메인이 역할을 수행하는 과정을 문서로 정리했다.
-   해당 문서를 바탕으로 테스트를 계층적으로 (@Nested 활용) 구성함.
-   해당 테스트코드를 통과시키는 방향으로 구현함 (TDD)
-   id의 필요성에 대한 고민
    -   도메인을 응답형태로 바꿔줘야했음
    -   API 응답 설계 상 응답형테에 id가 필요했기 때문에 도메인에도 id를 추가해줌.

# 설계 과정에서 가장 고민을 많이 했던 부분

---

-   도메인에서 역을 추가하는 과정이 가장 고민이 되었다.
-   그래서 놓치는 케이스가 없도록 분기별로 시나리오를 구분해놨다.

# 토론을 했지만 결론이 잘 안났거나 궁금한 내용

---

-   Sections가 너무 많은 객체와 행위를 물고있다.
-   노선에 역을 추가하는 행위를 어떻게하면 책임을 분리해볼 수 있을까..?
```


# Event

Thanks for 홍고 🍊

홍고랑 대화하다가 API 설계에 대한 이야기가 나왔다.

하나의 API 요청이 내부적으로 다른 역할을 수행한다는 말에 대해 반박하고있었는데 옆에 지나가던 체인저랑 콩하나랑 열띈 토론이 시작되었다.

## 농구

체인저, 그레이, 달리랑 올림픽공원에 가서 농구를 했다. 🏀

고등학교 때 이후로 너무 오랜만에 해서 감잡는데 시간이 좀 걸렸던 것 같다.

올림픽공원에서 4대4 밀어내기로 농구를 했는데 생각보다 많은 사람들이 

# Learn

## API의 단일책임?

뭔가 API URL이 단일책임을 가진다는 시각과, API 사용자가 사용하기 편하도록 다양한 행위가 조합된다는 시각의 충돌이 있었다.

DAO와 Repository의 관점과 유사한 개념이다.

결론은 프론트서버라는게 있고, 일할 때 단일개념을 개발한걸 프론트서버에서 조합하고 클라이언트가 사용하기 용이하게 만들어준다고 한다.

[[우아콘2020] 배민 프론트서버의 사실과 오해](https://www.youtube.com/watch?v=38cmd_fYwQk)

## DAO와 Repository를 분리한 이유

깃짱이 질문해줘서 스스로의 주관을 정리해볼 수 있었다.

DB 테이블구조와 1대1로 매핑되는 객체를 Entity라고 정의했다.

그리고 유의미한 행동을 수행하고 협력할 수 있는 객체를 Domain이라고 정의했다.

따라서 유의미한 행동을 할 수 있는 Domain이 비즈니스 로직을 담당하게 되었다.

계층의 관점으로 봤을 때 Service 계층은 비즈니스로직을 수행하는 부분이라고 정의했고, 결국 이 개념들이 조합되어 Service 계층에서는 Domain만 필요하게 되었다.

비즈니스 로직의 흐름 상 유의미한 정보를 가지지 못하는 (id만 가지고 있는) Entity는 Service 계층에서 사용할 필요가 없다.

여기서 한가지 문제가 발생한다.

Dao는 Entity를 이용해서 조회, 수정, 삭제, 생성이라는 행위를 하는데 정작 Service 계층에서 필요한건 Domain이다.

Domain을 만들어주려면 여러 테이블의 정보를 조회해서 조합을 해야하는데 이 행위를 특정 Dao가 가지기에는 단일 책임원칙을 위배하게 된다. 

DB 정보를 유의미한 도메인으로 조합해주는 계층이 있으면 어떨까? 라는 생각으로부터 Repository를 생각하게 되었다.

## TMI

- 필립은 고양이를 키운다.
- 뇌졸`중`은 영어로 stroke라고한다.
- 뇌졸`중`(腦卒中)은 북한말로 뇌졸`증`(腦卒症)이라고한다.

# Feel

옆에서 마스크를 쓰다듬고있는 홍고 옆에서 TIL을 쓰고있는데 덕분에 즐겁다 ^^ 🍊